{"version":3,"sources":["webpack:///./src/views/Payment.vue?bb2d","webpack:///src/views/Payment.vue","webpack:///./src/views/Payment.vue?3d33","webpack:///./src/views/Payment.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","routeName","staticClass","_m","_v","_e","_l","order","item","key","attrs","product","imageUrl","_s","title","qty","unit","_f","final_total","total","user","name","tel","email","address","message","is_paid","on","payOrder","staticRenderFns","data","computed","orderId","$route","params","id","methods","getOrder","$store","commit","$http","get","url","then","response","success","post","created","beforeRouteLeave","from","to","next","path","$modal","show","text","buttons","component"],"mappings":"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","file":"js/chunk-2d0aa5f4.2dd8e526.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('v-dialog'),(_vm.routeName === 'OrderDone')?_c('div',{staticClass:\"alert-box\"},[_vm._m(0),_c('p',[_vm._v(\" 親愛的顧客您好，您已付款成功，商品將於 2 日內送達，若喜歡我們的商品，歡迎關注我們的最新消息喔。 \")])]):_vm._e(),_c('h2',{staticClass:\"page__title--sm\"},[_vm._v(\"商品明細\")]),_c('div',{staticClass:\"cart no-delete\"},[_vm._m(1),_c('div',{staticClass:\"cart__list\"},_vm._l((_vm.order.products),function(item,key){return _c('div',{key:key,staticClass:\"cart__row bag-row no-gutters\"},[_c('div',{staticClass:\"cart__item bag-3 bag-md-2 cart__img\"},[_c('img',{attrs:{\"src\":item.product.imageUrl,\"alt\":\"item.product.title\"}})]),_c('div',{staticClass:\"bag-7 bag-md-8 bag-row no-gutters cart__group\"},[_c('div',{staticClass:\"cart__item cart__title bag-md-8\"},[_vm._v(\" \"+_vm._s(item.product.title)+\" \")]),_c('div',{staticClass:\"cart__item cart__num bag-md-4\"},[_c('span',{staticClass:\"cart__num__content no-padding\"},[_vm._v(_vm._s(item.qty)+_vm._s(item.product.unit))])])]),_c('div',{staticClass:\"bag cart__item cart__price\"},[_vm._v(\" \"+_vm._s(_vm._f(\"currency\")(item.final_total))+\" \")])])}),0),_c('div',{staticClass:\"cart__bottom\"},[_c('div',{staticClass:\"cart__total\"},[_c('div',{staticClass:\"cart__total__row\"},[_c('span',{staticClass:\"cart__total__row__title\"},[_vm._v(\"總額：\")]),_c('span',{staticClass:\"cart__total__row__content text-danger\"},[_vm._v(\" \"+_vm._s(_vm._f(\"currency\")(_vm.order.total))+\" \")])])])])]),_c('h2',{staticClass:\"page__title--sm\"},[_vm._v(\"訂購人資訊\")]),_c('div',{staticClass:\"order-detail\"},[_c('div',{staticClass:\"order-detail__row\"},[_c('div',{staticClass:\"order-detail__title\"},[_vm._v(\"姓名\")]),_c('div',{staticClass:\"order-detail__content\"},[_vm._v(_vm._s(_vm.order.user.name))])]),_c('div',{staticClass:\"order-detail__row\"},[_c('div',{staticClass:\"order-detail__title\"},[_vm._v(\"手機\")]),_c('div',{staticClass:\"order-detail__content\"},[_vm._v(_vm._s(_vm.order.user.tel))])]),_c('div',{staticClass:\"order-detail__row\"},[_c('div',{staticClass:\"order-detail__title\"},[_vm._v(\"email\")]),_c('div',{staticClass:\"order-detail__content\"},[_vm._v(_vm._s(_vm.order.user.email))])]),_c('div',{staticClass:\"order-detail__row\"},[_c('div',{staticClass:\"order-detail__title\"},[_vm._v(\"收件人地址\")]),_c('div',{staticClass:\"order-detail__content\"},[_vm._v(\" \"+_vm._s(_vm.order.user.address)+\" \")])]),_c('div',{staticClass:\"order-detail__row\"},[_c('div',{staticClass:\"order-detail__title\"},[_vm._v(\"備註\")]),_c('div',{staticClass:\"order-detail__content\"},[_vm._v(_vm._s(_vm.order.message))])]),_c('div',{staticClass:\"order-detail__row\"},[_c('div',{staticClass:\"order-detail__title\"},[_vm._v(\"付款狀態\")]),_c('div',{staticClass:\"order-detail__content\"},[(!_vm.order.is_paid)?_c('span',{staticClass:\"text-danger\"},[_vm._v(\"未付款\")]):_c('span',{staticClass:\"text-success\"},[_vm._v(\"已付款\")])])])]),_c('div',{staticClass:\"btn-wrapper-side\"},[(_vm.routeName === 'Payment')?_c('button',{staticClass:\"btn btn-primary\",on:{\"click\":_vm.payOrder}},[_vm._v(\" 確認付款 \")]):_vm._e(),(_vm.routeName === 'OrderDone')?_c('router-link',{staticClass:\"btn btn-primary\",attrs:{\"to\":\"/product-list\"}},[_vm._v(\"繼續逛逛\")]):_vm._e()],1)],1)}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('h1',{staticClass:\"page__title\"},[_c('i',{staticClass:\"far fa-check-circle\"}),_vm._v(\"感謝你的購買 \")])},function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"cart__head bag-row no-gutters\"},[_c('div',{staticClass:\"cart__item\"},[_vm._v(\"產品\")]),_c('div',{staticClass:\"cart__item\"},[_vm._v(\"數量\")]),_c('div',{staticClass:\"cart__item\"},[_vm._v(\"價格\")])])}]\n\nexport { render, staticRenderFns }","<template>\r\n  <div>\r\n    <v-dialog />\r\n    <div class=\"alert-box\" v-if=\"routeName === 'OrderDone'\">\r\n      <h1 class=\"page__title\">\r\n        <i class=\"far fa-check-circle\"></i>感謝你的購買\r\n      </h1>\r\n      <p>\r\n        親愛的顧客您好，您已付款成功，商品將於 2 日內送達，若喜歡我們的商品，歡迎關注我們的最新消息喔。\r\n      </p>\r\n    </div>\r\n    <h2 class=\"page__title--sm\">商品明細</h2>\r\n    <div class=\"cart no-delete\">\r\n      <div class=\"cart__head bag-row no-gutters\">\r\n        <div class=\"cart__item\">產品</div>\r\n        <div class=\"cart__item\">數量</div>\r\n        <div class=\"cart__item\">價格</div>\r\n      </div>\r\n      <div class=\"cart__list\">\r\n        <div\r\n          class=\"cart__row bag-row no-gutters\"\r\n          v-for=\"(item, key) in order.products\"\r\n          :key=\"key\"\r\n        >\r\n          <div class=\"cart__item bag-3 bag-md-2 cart__img\">\r\n            <img :src=\"item.product.imageUrl\" alt=\"item.product.title\" />\r\n          </div>\r\n          <div class=\"bag-7 bag-md-8 bag-row no-gutters cart__group\">\r\n            <div class=\"cart__item cart__title bag-md-8\">\r\n              {{ item.product.title }}\r\n            </div>\r\n            <div class=\"cart__item cart__num bag-md-4\">\r\n              <span class=\"cart__num__content no-padding\"\r\n                >{{ item.qty }}{{ item.product.unit }}</span\r\n              >\r\n            </div>\r\n          </div>\r\n          <div class=\"bag cart__item cart__price\">\r\n            {{ item.final_total | currency }}\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div class=\"cart__bottom\">\r\n        <div class=\"cart__total\">\r\n          <div class=\"cart__total__row\">\r\n            <span class=\"cart__total__row__title\">總額：</span>\r\n            <span class=\"cart__total__row__content text-danger\">\r\n              {{ order.total | currency }}\r\n            </span>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <h2 class=\"page__title--sm\">訂購人資訊</h2>\r\n    <div class=\"order-detail\">\r\n      <div class=\"order-detail__row\">\r\n        <div class=\"order-detail__title\">姓名</div>\r\n        <div class=\"order-detail__content\">{{ order.user.name }}</div>\r\n      </div>\r\n      <div class=\"order-detail__row\">\r\n        <div class=\"order-detail__title\">手機</div>\r\n        <div class=\"order-detail__content\">{{ order.user.tel }}</div>\r\n      </div>\r\n      <div class=\"order-detail__row\">\r\n        <div class=\"order-detail__title\">email</div>\r\n        <div class=\"order-detail__content\">{{ order.user.email }}</div>\r\n      </div>\r\n      <div class=\"order-detail__row\">\r\n        <div class=\"order-detail__title\">收件人地址</div>\r\n        <div class=\"order-detail__content\">\r\n          {{ order.user.address }}\r\n        </div>\r\n      </div>\r\n      <div class=\"order-detail__row\">\r\n        <div class=\"order-detail__title\">備註</div>\r\n        <div class=\"order-detail__content\">{{ order.message }}</div>\r\n      </div>\r\n      <div class=\"order-detail__row\">\r\n        <div class=\"order-detail__title\">付款狀態</div>\r\n        <div class=\"order-detail__content\">\r\n          <span class=\"text-danger\" v-if=\"!order.is_paid\">未付款</span\r\n          ><span class=\"text-success\" v-else>已付款</span>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div class=\"btn-wrapper-side\">\r\n      <button\r\n        class=\"btn btn-primary\"\r\n        @click=\"payOrder\"\r\n        v-if=\"routeName === 'Payment'\"\r\n      >\r\n        確認付款\r\n      </button>\r\n      <router-link\r\n        class=\"btn btn-primary\"\r\n        to=\"/product-list\"\r\n        v-if=\"routeName === 'OrderDone'\"\r\n        >繼續逛逛</router-link\r\n      >\r\n    </div>\r\n  </div>\r\n</template>\r\n<script>\r\nimport { mapGetters, mapActions } from 'vuex'\r\nexport default {\r\n  data () {\r\n    return {\r\n      order: {\r\n        user: {}\r\n      }\r\n    }\r\n  },\r\n  computed: {\r\n    orderId () {\r\n      return this.$route.params.id\r\n    },\r\n    routeName () {\r\n      return this.$route.name\r\n    },\r\n    ...mapGetters('cartModules', ['cart'])\r\n  },\r\n  methods: {\r\n    getOrder () {\r\n      const url = `${process.env.VUE_APP_APIPATH}/api/${process.env.VUE_APP_CUSTOMPATH}/order/${this.orderId}`\r\n      this.$store.commit('LOADING', true)\r\n      this.$http.get(url).then((response) => {\r\n        if (response.data.success) {\r\n          this.order = response.data.order\r\n          if (response.data.order === null) {\r\n            this.$bus.$emit('message:push', '訂單不存在', 'text-danger')\r\n          }\r\n        }\r\n        this.$store.commit('LOADING', false)\r\n      })\r\n    },\r\n    payOrder () {\r\n      const url = `${process.env.VUE_APP_APIPATH}/api/${process.env.VUE_APP_CUSTOMPATH}/pay/${this.orderId}`\r\n      this.$store.commit('LOADING', true)\r\n      this.$http.post(url).then((response) => {\r\n        if (response.data.success) {\r\n          this.$bus.$emit('message:push', response.data.message)\r\n          this.getOrder()\r\n          this.$router.push({\r\n            name: 'OrderDone',\r\n            params: {\r\n              id: this.orderId\r\n            }\r\n          })\r\n        }\r\n        this.$store.commit('LOADING', false)\r\n      })\r\n    },\r\n    ...mapActions('cartModules', ['getCart'])\r\n  },\r\n  created () {\r\n    this.getOrder()\r\n  },\r\n  beforeRouteLeave (to, from, next) {\r\n    if (from.name === 'OrderDone' && to.name === 'Payment') {\r\n      next({\r\n        path: '/'\r\n      })\r\n    }\r\n    if (\r\n      to.name !== 'OrderDone' &&\r\n      from.name !== 'OrderDone' &&\r\n      !this.order.is_paid\r\n    ) {\r\n      this.$modal.show('dialog', {\r\n        text: '您尚未付款，確定要離開嗎？',\r\n        buttons: [\r\n          {\r\n            title: '取消',\r\n            handler: () => {\r\n              this.$modal.hide('dialog')\r\n              next(false)\r\n            }\r\n          },\r\n          {\r\n            title: '確定',\r\n            handler: () => {\r\n              next()\r\n            }\r\n          }\r\n        ]\r\n      })\r\n    } else {\r\n      next()\r\n    }\r\n  }\r\n}\r\n</script>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Payment.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Payment.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Payment.vue?vue&type=template&id=48e13cfd&\"\nimport script from \"./Payment.vue?vue&type=script&lang=js&\"\nexport * from \"./Payment.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}