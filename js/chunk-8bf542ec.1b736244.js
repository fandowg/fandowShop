(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-8bf542ec"],{"43ea":function(t,e,a){t.exports=a.p+"img/next_page_disabled.7fd955a2.svg"},4409:function(t,e,a){t.exports=a.p+"img/prev_page_disabled.5301e053.svg"},"720c":function(t,e,a){t.exports=a.p+"img/prev_page.8fbf6e37.svg"},"80a6":function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("nav",{attrs:{"aria-label":"Page navigation"}},[i("ul",{staticClass:"pagination"},[i("li",{staticClass:"pagination__item"},[i("a",{staticClass:"pagination__link",class:{disabled:!t.pagination.has_pre},on:{click:function(e){return e.preventDefault(),t.$emit("get-pages",t.pagination.current_page-1)}}},[t.pagination.has_pre?i("img",{attrs:{src:a("720c")}}):i("img",{attrs:{src:a("4409")}})])]),t._l(t.pagination.total_pages,(function(e){return i("li",{key:e,staticClass:"pagination__item"},[i("a",{staticClass:"pagination__link",class:{active:t.pagination.current_page===e,disabled:t.pagination.total_pages<=1},on:{click:function(a){return a.preventDefault(),t.$emit("get-pages",e)}}},[t._v(t._s(e))])])})),i("li",{staticClass:"pagination__item"},[i("a",{staticClass:"pagination__link",class:{disabled:!t.pagination.has_next},on:{click:function(e){return e.preventDefault(),t.$emit("get-pages",t.pagination.current_page+1)}}},[t.pagination.has_next?i("img",{attrs:{src:a("d715")}}):i("img",{attrs:{src:a("43ea")}})])])],2)])},s=[],n={props:["pagination","get-pages"],data:function(){return{}}},o=n,d=a("2877"),c=Object(d["a"])(o,i,s,!1,null,null,null);e["a"]=c.exports},c5fc:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("EditCoupons",{attrs:{"is-new":t.isNew,"temp-coupon":t.tempCoupon,today:t.today},on:{close:t.closeModal,"get-coupons":t.getCoupons}}),a("v-dialog"),a("div",{staticClass:"menu-block menu-block--inline"},[a("h1",{staticClass:"page__title"},[t._v("優惠券列表")]),a("button",{staticClass:"btn btn-primary",on:{click:function(e){return t.openModal(!0)}}},[t._v(" 新增優惠券 ")])]),a("div",{staticClass:"admin"},[t._m(0),a("div",{staticClass:"admin__list"},t._l(t.coupons,(function(e){return a("div",{key:e.id,staticClass:"admin__row bag-row no-gutters"},[a("div",{staticClass:"admin__item admin__title bag-md-4 bag-12"},[t._v(" "+t._s(e.title)+" ")]),a("div",{staticClass:"admin__item bag-md bag-4"},[a("span",{staticClass:"desk-hide-md"},[t._v("折扣 ")]),t._v(t._s(e.percent)+"% ")]),a("div",{staticClass:"admin__item bag-md-2 bag-6"},[a("span",{staticClass:"desk-hide-md"},[t._v("到期日")]),t._v(" "+t._s(t._f("date")(e.due_date))+" ")]),a("div",{staticClass:"admin__item bag-md bag-2 text-right-max-md"},[e.is_enabled?a("span",[t._v("啟用")]):a("span",[t._v("未啟用")])]),a("div",{staticClass:"admin__item bag-md bag-6 text-right-min-md"},[a("button",{staticClass:"btn btn-primary btn-sm",on:{click:function(a){return t.openModal(!1,e)}}},[t._v(" 編輯 ")])]),a("div",{staticClass:"admin__item bag-md bag-6 text-right"},[a("button",{staticClass:"btn btn-outline-primary btn-sm",on:{click:function(a){return t.deleteCoupon(e.id,e)}}},[t._v(" 刪除 ")])])])})),0)]),a("PageApi",{attrs:{pagination:t.pagination},on:{"get-pages":t.getCoupons}})],1)},s=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"admin__head bag-row no-gutters"},[a("div",{staticClass:"admin__item admin__title bag-md-4"},[t._v("名稱")]),a("div",{staticClass:"admin__item bag-md"},[t._v("折扣百分比")]),a("div",{staticClass:"admin__item bag-md-2"},[t._v("到期日")]),a("div",{staticClass:"admin__item bag-md text-right-max-md"},[t._v("是否啟用")]),a("div",{staticClass:"admin__item bag-md text-right-min-md"},[t._v("編輯")]),a("div",{staticClass:"admin__item bag-md text-right"},[t._v("刪除")])])}],n=(a("99af"),a("ac1f"),a("1276"),function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("modal",{attrs:{name:"editCoupons",adaptive:!0,shiftY:.3,maxWidth:800,width:"95%",height:"auto",scrollable:!0}},[i("div",{staticClass:"edit-page"},[i("ValidationObserver",{scopedSlots:t._u([{key:"default",fn:function(e){var s=e.handleSubmit;return[i("button",{staticClass:"close-position button-none",on:{click:function(e){return t.$emit("close")}}},[i("img",{attrs:{src:a("214b")}})]),i("h2",{staticClass:"edit-page__title"},[t.isNew?i("span",[t._v("新增")]):i("span",[t._v("編輯")]),t._v("優惠券 ")]),i("div",{staticClass:"edit"},[i("div",{staticClass:"edit__row form-row"},[i("div",{staticClass:"edit__item bag-md-6 form-group"},[i("ValidationProvider",{attrs:{name:"優惠名稱",rules:"required"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.failed,s=e.errors;return[i("label",{attrs:{for:"title"}},[t._v("優惠名稱")]),i("input",{directives:[{name:"model",rawName:"v-model",value:t.editTemp.title,expression:"editTemp.title"}],staticClass:"form-control",attrs:{type:"text",id:"title",placeholder:"請輸入優惠名稱"},domProps:{value:t.editTemp.title},on:{input:function(e){e.target.composing||t.$set(t.editTemp,"title",e.target.value)}}}),a?i("span",{staticClass:"text-danger"},[t._v(t._s(s[0]))]):t._e()]}}],null,!0)})],1),i("div",{staticClass:"edit__item bag-md-6 form-group"},[i("ValidationProvider",{attrs:{name:"優惠碼",rules:"required"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.failed,s=e.errors;return[i("label",{attrs:{for:"code"}},[t._v("優惠碼")]),i("input",{directives:[{name:"model",rawName:"v-model",value:t.editTemp.code,expression:"editTemp.code"}],staticClass:"form-control",attrs:{type:"text",id:"code",placeholder:"請輸入優惠碼"},domProps:{value:t.editTemp.code},on:{input:function(e){e.target.composing||t.$set(t.editTemp,"code",e.target.value)}}}),a?i("span",{staticClass:"text-danger"},[t._v(t._s(s[0]))]):t._e()]}}],null,!0)})],1)]),i("div",{staticClass:"edit__row form-row"},[i("div",{staticClass:"edit__item bag-md-6 form-group"},[i("ValidationProvider",{attrs:{name:"到期日",rules:"required"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.failed,s=e.errors;return[i("label",{attrs:{for:"due_date"}},[t._v("到期日")]),i("input",{directives:[{name:"model",rawName:"v-model",value:t.due_date_model,expression:"due_date_model"}],staticClass:"form-control",attrs:{type:"date",id:"due_date",placeholder:"請輸入到期日"},domProps:{value:t.due_date_model},on:{input:function(e){e.target.composing||(t.due_date_model=e.target.value)}}}),a?i("span",{staticClass:"text-danger"},[t._v(t._s(s[0]))]):t._e()]}}],null,!0)})],1),i("div",{staticClass:"edit__item bag-md-6 form-group"},[i("ValidationProvider",{attrs:{name:"折扣(%)",rules:"required"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.failed,s=e.errors;return[i("label",{attrs:{for:"percent"}},[t._v("折扣")]),i("input",{directives:[{name:"model",rawName:"v-model",value:t.editTemp.percent,expression:"editTemp.percent"}],staticClass:"form-control",attrs:{type:"number",id:"percent",placeholder:"請輸入折扣數字(%)"},domProps:{value:t.editTemp.percent},on:{input:function(e){e.target.composing||t.$set(t.editTemp,"percent",e.target.value)}}}),a?i("span",{staticClass:"text-danger"},[t._v(t._s(s[0]))]):t._e()]}}],null,!0)})],1)]),i("div",{staticClass:"edit__item form-group"},[i("div",{staticClass:"form-check"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.editTemp.is_enabled,expression:"editTemp.is_enabled"}],staticClass:"form-check-input",attrs:{type:"checkbox",id:"is_enabled","true-value":1,"false-value":0},domProps:{checked:Array.isArray(t.editTemp.is_enabled)?t._i(t.editTemp.is_enabled,null)>-1:t._q(t.editTemp.is_enabled,1)},on:{change:function(e){var a=t.editTemp.is_enabled,i=e.target,s=i.checked?1:0;if(Array.isArray(a)){var n=null,o=t._i(a,n);i.checked?o<0&&t.$set(t.editTemp,"is_enabled",a.concat([n])):o>-1&&t.$set(t.editTemp,"is_enabled",a.slice(0,o).concat(a.slice(o+1)))}else t.$set(t.editTemp,"is_enabled",s)}}}),i("label",{staticClass:"form-check-label",attrs:{for:"is_enabled"}},[t._v("是否啟用")])])]),i("div",{staticClass:"btn-wrapper-side"},[i("button",{staticClass:"btn btn-outline-primary",on:{click:function(e){return t.$emit("close")}}},[t._v(" 取消 ")]),i("button",{staticClass:"btn btn-primary",on:{click:function(e){return s(t.updateCoupon)}}},[t._v(" 送出 ")])])])]}}])})],1)])}),o=[],d=a("5530"),c={props:["isNew","tempCoupon","today"],data:function(){return{due_date_model:"",editTemp:{}}},watch:{due_date_model:function(){this.editTemp.due_date=Math.floor(new Date(this.due_date_model))/1e3},tempCoupon:function(){this.isNew?(this.editTemp=Object(d["a"])({},this.tempCoupon),this.due_date_model=this.today,this.editTemp.due_date=Math.floor(new Date(this.today))/1e3):(this.editTemp=Object.assign({},this.tempCoupon),this.due_date_model=new Date(1e3*this.editTemp.due_date).toISOString().split("T")[0])}},methods:{updateCoupon:function(){var t=this;if(this.isNew){this.$store.commit("LOADING",!0);var e="".concat("https://vue-course-api.hexschool.io","/api/").concat("fandow","/admin/coupon");this.$http.post(e,{data:this.editTemp}).then((function(e){e.data.success&&(t.$emit("get-coupons"),t.$bus.$emit("message:push",e.data.message)),t.$store.commit("LOADING",!1),t.$emit("close")}))}else{if(JSON.stringify(this.editTemp)===JSON.stringify(this.tempCoupon))return void this.$emit("close");this.$store.commit("LOADING",!0);var a="".concat("https://vue-course-api.hexschool.io","/api/").concat("fandow","/admin/coupon/").concat(this.editTemp.id);this.$http.put(a,{data:this.editTemp}).then((function(e){e.data.success&&(t.$emit("get-coupons"),t.$bus.$emit("message:push",e.data.message)),t.$store.commit("LOADING",!1),t.$emit("close")}))}}}},r=c,l=a("2877"),p=Object(l["a"])(r,n,o,!1,null,null,null),u=p.exports,m=a("80a6"),_={data:function(){return{coupons:{},tempCoupon:{},today:"",pagination:{},isNew:!1,text:""}},watch:{pagination:function(){this.toTop()}},methods:{getCoupons:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.$store.commit("LOADING",!0);var a="".concat("https://vue-course-api.hexschool.io","/api/").concat("fandow","/admin/coupons?page=").concat(e);this.$http.get(a).then((function(e){e.data.success&&(t.coupons=e.data.coupons,t.pagination=e.data.pagination),t.$store.commit("LOADING",!1)}))},deleteCoupon:function(t,e){var a=this;this.$modal.show("dialog",{text:"確定要刪除<br>「".concat(e.title,"」嗎？"),buttons:[{title:"取消",handler:function(){a.$modal.hide("dialog")}},{title:"確定",handler:function(){var e="".concat("https://vue-course-api.hexschool.io","/api/").concat("fandow","/admin/coupon/").concat(t);a.$store.commit("LOADING",!0),a.$http.delete(e).then((function(t){t.data.success?(a.getCoupons(),a.$bus.$emit("message:push",t.data.message)):a.$bus.$emit("message:push",t.data.message,"text-danger"),a.$modal.hide("dialog"),a.$store.commit("LOADING",!1)}))}}]})},openModal:function(t,e){this.$modal.show("editCoupons"),t?(this.tempCoupon={due_date:0,is_enabled:0},this.isNew=t,this.today=(new Date).toISOString().split("T")[0]):(this.tempCoupon=e,this.isNew=t)},closeModal:function(){this.$modal.hide("editCoupons")},toTop:function(){document.documentElement.scrollTop=0}},components:{EditCoupons:u,PageApi:m["a"]},created:function(){this.getCoupons()}},g=_,v=Object(l["a"])(g,i,s,!1,null,null,null);e["default"]=v.exports},d715:function(t,e,a){t.exports=a.p+"img/next_page.cffd41cd.svg"}}]);
//# sourceMappingURL=chunk-8bf542ec.1b736244.js.map